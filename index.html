<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

  <!-- iOS„ÅÆË¶ã„ÅüÁõÆ„Éí„É≥„ÉàÔºàÂõ∫ÂÆö„Åó„Å™„ÅÑ„ÄÇËâ≤„ÅØJS„ÅßÂ§â„Åà„ÇãÔºâ -->
  <meta name="color-scheme" content="light dark" />
  <meta name="theme-color" content="#f4f4f4" />

  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500&display=swap" rel="stylesheet">

  <title>Êô¥„ÉÅ„É£„ÉÉ„Éà</title>

  <style>
    :root{
      --bg-main: #f4f4f4;
      --bg-header: rgba(255,255,255,0.86);
      --bg-bot: #ffffff;
      --bg-user: #e8e8e8;
      --text-main:#111;
      --border-color:#ddd;

      --shadow-soft: 0 8px 22px rgba(0,0,0,0.08);
      --shadow-dark: 0 10px 28px rgba(0,0,0,0.35);
    }

    body.dark{
      --bg-main: transparent; /* ËÉåÊôØ„ÅØ„Ç∞„É©„Éá„ÅßÊèè„Åè */
      --bg-header: rgba(15,22,35,0.65);
      --bg-bot: rgba(22,33,50,0.92);
      --bg-user: rgba(31,58,77,0.92);
      --text-main:#e6f0ff;
      --border-color: rgba(255,255,255,0.08);
    }

    body{
      margin:0;
      font-family: "Noto Sans JP", -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-main);
      color: var(--text-main);
      display:flex;
      flex-direction:column;
      height:100dvh;
    }

    /* Â§úÁ©∫„Ç∞„É©„ÉáÔºàbody.dark „ÅÆ„Å®„Åç„Å†„ÅëÔºâ */
    body.dark{
      background: linear-gradient(
        to bottom,
        #0f1c2e,
        #0c1624 45%,
        #0a1320
      );
    }

    /* ===== Header ===== */
    #header{
      background: var(--bg-header);
      -webkit-backdrop-filter: blur(12px);
      backdrop-filter: blur(12px);

      padding: 10px 12px;
      border-bottom: 1px solid var(--border-color);
      font-weight: 600;

      position: sticky;
      top:0;
      z-index: 20;

      display:flex;
      align-items:center;
      gap:8px;
    }

    #menuBtn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-size:22px;
      width:44px;
      height:44px;
      border:none;
      background:transparent;
      cursor:pointer;
      color: var(--text-main);
    }

    #darkBtn{
      width:44px;
      height:44px;
      border-radius: 14px;
      border: 1px solid var(--border-color);
      background: rgba(255,255,255,0.06);
      color: var(--text-main);
      cursor: pointer;
    }

    /* ===== Log ===== */
    #log{
      flex:1;
      overflow-y:auto;
      padding:12px;
      box-sizing:border-box;
    }

    .msg{
      margin: 8px 0;
      padding: 12px 16px;
      border-radius: 18px;
      max-width: 80%;
      white-space: pre-wrap;
      line-height: 1.6;
      box-sizing: border-box;
    }

    /* „É¶„Éº„Ç∂„Éº */
    .me{
      background: var(--bg-user);
      margin-left:auto;
      font-weight: 500;
      border: 1px solid transparent;
    }

    /* „Éú„ÉÉ„Éà */
    .bot{
      background: var(--bg-bot);
      border: 1px solid var(--border-color);
      font-weight: 400;
    }

    /* ÂΩ±ÔºöÂ§ú„Å†„ÅëÂ∞ë„ÅóÂº∑„ÇÅ„ÄÇÁôΩ„ÅØÂº±„ÇÅ or „Å™„Åó */
    body.dark .msg{
      box-shadow: var(--shadow-dark);
    }
    body:not(.dark) .bot{
      box-shadow: var(--shadow-soft);
    }
    body:not(.dark) .me{
      box-shadow: none; /* ÁôΩ„É¢„Éº„ÉâÔºö„Ç∞„É¨„ÉºÂêπ„ÅçÂá∫„Åó„Å´ÂΩ±„ÅÑ„Çâ„Å™„ÅÑ */
    }

    /* „Çø„Ç§„É†„Çπ„Çø„É≥„ÉóÔºöÁÆ±„ÇíÊ∂à„Åó„Å¶ÊñáÂ≠ó„Å†„Åë */
    .timestamp{
      font-size: 10px;
      margin: 2px 12px;
      padding: 0;
      background: transparent !important;
      border: 0 !important;
      box-shadow: none !important;
      opacity: 0.45;
    }
    body:not(.dark) .timestamp{ color:#666; }
    body.dark .timestamp{ color: rgba(255,255,255,0.25); }

    .timestamp.me{ text-align:right; }
    .timestamp.bot{ text-align:left; }

    /* ===== Input Area ===== */
    #inputArea{
      position: fixed;
      left:0;
      right:0;
      bottom:0;
      width:auto;

      padding:10px;
      box-sizing:border-box;

      display:flex;
      gap:8px;
      align-items:flex-end;

      border-top: 1px solid var(--border-color);

      background: var(--bg-header);
      -webkit-backdrop-filter: blur(14px);
      backdrop-filter: blur(14px);
    }

    /* Â§ú„Å†„Åë ‚ÄúÈÄè„Åë‚Äù „ÇíÂº∑„ÇÅ„Çã */
    body.dark #inputArea{
      background: rgba(15,22,35,0.58);
      border-top: 1px solid rgba(255,255,255,0.08);
    }

    #msg{
      flex:1;
      min-height:80px;
      max-height:160px;
      resize:none;
      overflow-y:auto;
      padding:12px;

      background: var(--bg-bot);
      color: var(--text-main);
      border: 1px solid var(--border-color);
      border-radius: 22px;

      box-sizing:border-box;
      font-size:16px;
    }

    body.dark #msg{
      background: rgba(22,33,50,0.92);
      box-shadow: 0 2px 10px rgba(0,0,0,0.25);
    }

    #msg::placeholder{
      color: rgba(230,240,255,0.38);
    }
    body:not(.dark) #msg::placeholder{
      color: rgba(0,0,0,0.30);
    }

    #sendBtn{
      width:44px;
      height:44px;
      border-radius:50%;
      border:none;
      background:#10a37f;
      color:#fff;
      font-size:18px;
      cursor:pointer;
      flex: 0 0 auto;
    }
    #sendBtn:hover{ opacity:0.9; }

    .loadingBtn{
      background:#999 !important;
      cursor:not-allowed !important;
      opacity:0.7;
    }

    /* ===== Sidebar ===== */
    #sidebarOverlay{
      display:none;
      position:fixed;
      inset:0;
      background: rgba(0,0,0,0.3);
      z-index:40;
    }

    #sidebar{
      position: fixed;
      top:0; left:0; bottom:0;
      width:260px;

      background: var(--bg-header);
      -webkit-backdrop-filter: blur(12px);
      backdrop-filter: blur(12px);

      border-right: 1px solid var(--border-color);

      transform: translateX(-110%);
      transition: transform .2s ease;
      z-index: 50;
      padding: 10px;
      box-sizing: border-box;
    }

    #sidebar.open{ transform: translateX(0); }

    #sidebar .title{
      font-weight: 700;
      margin: 6px 0 10px 0;
      color: var(--text-main);
    }

    #sessionsInSidebar button{
      width:100%;
      text-align:left;
      padding:10px;
      margin:6px 0;
      border-radius: 12px;
      border: 1px solid var(--border-color);
      background: var(--bg-bot);
      color: var(--text-main);
      cursor:pointer;
    }
    body.dark #sessionsInSidebar button{
      background: rgba(22,33,50,0.92);
    }

    #newSessionBtn{
      width:100%;
      height:44px;
      border-radius:12px;
      border:1px solid var(--border-color);
      background: var(--bg-bot);
      color: var(--text-main);
      cursor:pointer;
    }
    body.dark #newSessionBtn{
      background: rgba(22,33,50,0.92);
    }

    /* PCÔºö„Çµ„Ç§„Éâ„Éê„ÉºÂ∏∏ÊôÇ */
    @media (min-width: 768px){
      #sidebarOverlay{ display:none !important; }
      #sidebar{
        transform: translateX(0);
        z-index: 30;
      }
      #header{ margin-left:260px; }
      #log{ margin-left:260px; }
      #inputArea{
        left:260px;
        width: calc(100% - 260px);
      }
    }
  </style>
</head>

<body>
  <div id="sidebarOverlay" onclick="closeSidebar()"></div>

  <div id="sidebar">
    <div class="title">„Çª„ÉÉ„Ç∑„Éß„É≥‰∏ÄË¶ß</div>
    <div id="sessionsInSidebar"></div>
    <div style="margin-top:10px;">
      <button id="newSessionBtn" onclick="newSession()">Ôºã Êñ∞„Åó„ÅÑÂØæË©±</button>
    </div>
  </div>

  <div id="header">
    <button id="menuBtn" onclick="toggleSidebar()">‚ò∞</button>
    <span style="flex:1;">Êô¥ - chat</span>
    <button id="darkBtn" onclick="toggleDark()">üåô</button>
  </div>

  <div id="log"></div>

  <div id="inputArea">
    <textarea id="msg" placeholder="„Å≤„Åï„ÅÆË®ÄËëâ‚Ä¶"></textarea>
    <button id="sendBtn" onclick="send()">‚û§</button>
  </div>

  <script src="ui.js"></script>
  <script src="api.js"></script>
  <script src="app.js"></script>
</body>
</html>
