<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Êô¥„ÉÅ„É£„ÉÉ„Éà</title>

  <style>
    :root{
      /* ===== Light (default) ===== */
      --bg-main: #f4f4f4;
      --bg-header: rgba(255,255,255,0.92);
      --bg-bot: #ffffff;
      --bg-user: #e9e9e9;

      --text-main: #111;
      --text-sub: rgba(17,17,17,0.55);

      --border-color: rgba(0,0,0,0.10);

      --shadow-soft: 0 6px 18px rgba(0,0,0,0.06);
      --shadow-bubble: 0 4px 14px rgba(0,0,0,0.08);

      --input-bg: rgba(255,255,255,0.70);
      --input-border: rgba(0,0,0,0.12);
    }

    body.dark{
      /* ===== Dark (night sky) ===== */
      --bg-main: #0f1623;
      --bg-header: rgba(18,28,43,0.82);
      --bg-bot: #182233;
      --bg-user: #1f3a4d;

      --text-main: #e6f0ff;
      --text-sub: rgba(230,240,255,0.40);

      --border-color: rgba(255,255,255,0.08);

      --shadow-soft: 0 10px 26px rgba(0,0,0,0.35);
      --shadow-bubble: 0 6px 18px rgba(0,0,0,0.28);

      --input-bg: rgba(15,22,35,0.58);
      --input-border: rgba(255,255,255,0.10);
    }

    body{
      margin:0;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      color: var(--text-main);

      /* ËÉåÊôØÔºö„É©„Ç§„Éà„ÅØÂçòËâ≤„ÄÅ„ÉÄ„Éº„ÇØ„ÅØÂ§úÁ©∫„Ç∞„É©„Éá */
      background: var(--bg-main);
      display:flex;
      flex-direction:column;
      height:100dvh;
    }

    body.dark{
      background: linear-gradient(
        to bottom,
        #0f1c2e 0%,
        #0c1624 45%,
        #0a1320 100%
      );
    }

    /* ===== Header ===== */
    #header{
      background: var(--bg-header);
      border-bottom: 1px solid var(--border-color);
      padding: 10px 12px;

      position: sticky;
      top: 0;
      z-index: 40;

      display:flex;
      align-items:center;
      gap: 8px;

      backdrop-filter: blur(10px);
    }

    #menuBtn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-size: 22px;
      width:44px;
      height:44px;
      border:none;
      background:transparent;
      cursor:pointer;
      color: var(--text-main);
    }

    #title{
      flex: 1;
      font-weight: 700;
      letter-spacing: 0.2px;
    }

    #darkBtn{
      width:44px;
      height:44px;
      border-radius: 12px;
      border: 1px solid var(--border-color);
      background: rgba(255,255,255,0.06);
      color: var(--text-main);
      cursor: pointer;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }
    body:not(.dark) #darkBtn{ background: rgba(0,0,0,0.04); }

    /* ===== Chat Log ===== */
    #log{
      flex:1;
      overflow-y:auto;
      padding: 12px;
      box-sizing:border-box;
    }

    .msg{
      margin: 8px 0;
      padding: 12px 14px;
      border-radius: 18px;
      max-width: 84%;
      white-space: pre-wrap;
      line-height: 1.55;
      box-shadow: var(--shadow-bubble);
    }

    .me{
      background: var(--bg-user);
      margin-left:auto;
      font-weight: 600;  /* „Å≤„ÅïÂÅ¥Â∞ë„ÅóÂ§™„Åè */
    }

    .bot{
      background: var(--bg-bot);
      border: 1px solid var(--border-color);
      font-weight: 500;
    }

    /* „Åï„Çâ„Å´Â§úÁ©∫„É¢„Éº„Éâ„ÅØËº™ÈÉ≠„ÇíËñÑ„Åè */
    body.dark .bot{
      border: 1px solid rgba(255,255,255,0.05);
    }

    /* ===== Timestamp (ÁÆ±„ÇíÊ∂à„Åó„Å¶„ÄÅÊï∞Â≠ó„Å†„Åë) ===== */
    .timestamp{
      font-size: 10px;
      margin: 2px 12px;
      background: transparent;
      border: none;
      opacity: 0.9;
      color: var(--text-sub);
      letter-spacing: 0.2px;
    }
    .timestamp.me{ text-align:right; }
    .timestamp.bot{ text-align:left; }
	
body.dark .timestamp {
  color: rgba(230,240,255,0.25);
}


    /* ===== Input Area ===== */
    #inputArea{
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;

      padding: 10px;
      box-sizing: border-box;
      display:flex;
      gap: 8px;
      align-items:flex-end;

      background: var(--input-bg);
      border-top: 1px solid var(--input-border);
      backdrop-filter: blur(12px);
      z-index: 30;
    }

    #msg{
      flex:1;
      min-height: 64px;
      max-height: 160px;
      resize:none;
      overflow-y:auto;
      padding: 12px 14px;

      background: rgba(255,255,255,0.85);
      color: var(--text-main);
      border: 1px solid var(--border-color);
      border-radius: 22px;

      box-sizing:border-box;
      font-size: 16px;
      outline: none;
    }

    body.dark #msg{
      background: rgba(22,33,50,0.95);
      border: 1px solid rgba(255,255,255,0.10);
      box-shadow: 0 6px 18px rgba(0,0,0,0.25);
    }

    #msg::placeholder{
      color: var(--text-sub);
    }

    #sendBtn{
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: none;
      background: #10a37f;
      color: white;
      font-size: 18px;
      cursor: pointer;
      flex: 0 0 auto;
      box-shadow: var(--shadow-soft);
    }
    #sendBtn:hover{ opacity: 0.9; }

    .loadingBtn{
      background:#999 !important;
      cursor:not-allowed !important;
      opacity:0.7;
    }

    /* ===== Typing ===== */
    .typing{
      display:flex;
      align-items:center;
      gap:4px;
      font-size:14px;
      color: var(--text-sub);
      box-shadow:none;
      border:none;
      background: transparent;
      padding: 6px 8px;
    }
    .dot{ animation: blink 1.4s infinite both; }
    .dot:nth-child(2){ animation-delay: .2s; }
    .dot:nth-child(3){ animation-delay: .4s; }
    @keyframes blink{
      0%{ opacity:.2; }
      20%{ opacity:1; }
      100%{ opacity:.2; }
    }

    /* ===== Sidebar ===== */
    #sidebarOverlay{
      display:none;
      position:fixed;
      top:0; left:0; right:0; bottom:0;
      background: rgba(0,0,0,0.35);
      z-index: 50;
    }

    #sidebar{
      position: fixed;
      top:0; left:0; bottom:0;
      width:260px;
      background: var(--bg-header);
      border-right: 1px solid var(--border-color);
      transform: translateX(-110%);
      transition: transform .2s ease;
      z-index: 60;
      padding: 14px 10px;
      box-sizing:border-box;
      backdrop-filter: blur(12px);
    }
    #sidebar.open{ transform: translateX(0); }

    #sidebar .title{
      font-weight: 800;
      margin: 6px 0 10px 2px;
      color: var(--text-main);
    }

    #sessionsInSidebar button{
      width:100%;
      text-align:left;
      padding: 10px 12px;
      margin: 6px 0;
      border-radius: 12px;
      border: 1px solid var(--border-color);
      background: rgba(255,255,255,0.06);
      cursor:pointer;
      color: var(--text-main);
      box-shadow: none;
    }

    body.dark #sessionsInSidebar button{
      background: rgba(22,33,50,0.80);
      border: 1px solid rgba(255,255,255,0.10);
    }

    #sessionsInSidebar button:hover{
      filter: brightness(1.05);
    }

    #newSessionBtn{
      width: 100%;
      height: 44px;
      border-radius: 14px;
      border: 1px solid var(--border-color);
      background: rgba(255,255,255,0.10);
      color: var(--text-main);
      cursor:pointer;
      margin-top: 10px;
    }
    body.dark #newSessionBtn{
      background: rgba(22,33,50,0.65);
      border: 1px solid rgba(255,255,255,0.10);
    }

    /* ===== Desktop layout ===== */
    @media (min-width: 768px){
      #sidebarOverlay{ display:none !important; }
      #sidebar{
        transform: translateX(0);
        z-index: 60;
      }
      #header, #log{
        margin-left: 260px;
      }
      #inputArea{
        left: 260px;
        width: calc(100% - 260px);
      }
    }
	/* „Åì„Åì„Åã„ÇâËøΩÂä† */

body:not(.dark) .msg {
  box-shadow: none;
}

body.dark .timestamp {
  color: rgba(230,240,255,0.25);
}

/* „Åì„Åì„ÅßÁµÇ‰∫Ü */
  </style>
</head>

<body>
  <div id="sidebarOverlay" onclick="closeSidebar()"></div>

  <div id="sidebar">
    <div class="title">„Çª„ÉÉ„Ç∑„Éß„É≥‰∏ÄË¶ß</div>
    <div id="sessionsInSidebar"></div>
    <button id="newSessionBtn" onclick="newSession()">Ôºã Êñ∞„Åó„ÅÑÂØæË©±</button>
  </div>

  <div id="header">
    <button id="menuBtn" onclick="toggleSidebar()">‚ò∞</button>
    <div id="title">Êô¥ - chat</div>
    <button id="darkBtn" onclick="toggleDark()" title="Dark mode">üåô</button>
  </div>

  <div id="log"></div>

  <div id="inputArea">
    <textarea id="msg" placeholder="„Å≤„Åï„ÅÆË®ÄËëâ‚Ä¶"></textarea>
    <button id="sendBtn" onclick="send()">‚û§</button>
  </div>

  <script src="ui.js"></script>
  <script src="api.js"></script>
  <script src="app.js"></script>
</body>
</html>
